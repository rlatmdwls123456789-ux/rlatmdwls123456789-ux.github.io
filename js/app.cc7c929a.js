(function(){"use strict";var e={2508:function(e,t,o){var n=o(5130),a=(o(4114),o(6768)),l=o(144),s=o(1387);const r={class:"auth-actions"};function i(e,t,o,n,l,s){const i=(0,a.g2)("v-icon"),c=(0,a.g2)("v-btn"),d=(0,a.g2)("v-spacer"),u=(0,a.g2)("v-app-bar");return(0,a.uX)(),(0,a.Wv)(u,{app:"",elevation:"0",class:"header-bar"},{default:(0,a.k6)((()=>[(0,a.bF)(c,{variant:"text",class:"nav-btn brand-btn",to:{path:"/"}},{default:(0,a.k6)((()=>[t[0]||(t[0]=(0,a.Lk)("p",{class:"text-h5 font-weight-bold"},"Web Piano",-1)),(0,a.bF)(i,{icon:"mdi-piano",size:"x-large"})])),_:1}),(0,a.bF)(c,{variant:"text",class:"nav-btn",to:{path:"/member/list"}},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("회원목록")]))),_:1}),(0,a.bF)(c,{variant:"text",class:"nav-btn",to:{path:"/groupchatting/list"}},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("채팅방목록")]))),_:1}),(0,a.bF)(d),(0,a.Lk)("div",r,[l.isLogin?((0,a.uX)(),(0,a.Wv)(c,{key:0,class:"pill-btn",to:{path:"/my/chat/page"},"prepend-icon":"mdi-account-circle"},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)(" My Chat ")]))),_:1})):(0,a.Q3)("",!0),l.isLogin?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(c,{key:1,class:"pill-btn",color:"primary",variant:"flat",to:{path:"/member/create"}},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)(" 회원가입 ")]))),_:1})),l.isLogin?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(c,{key:2,class:"pill-btn",variant:"tonal",to:{path:"/login"}},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)(" 로그인 ")]))),_:1})),l.isLogin?((0,a.uX)(),(0,a.Wv)(c,{key:3,class:"pill-btn",color:"red-accent-2",variant:"tonal",onClick:s.doLogout},{default:(0,a.k6)((()=>t[6]||(t[6]=[(0,a.eW)(" 로그아웃 ")]))),_:1},8,["onClick"])):(0,a.Q3)("",!0)])])),_:1})}var c={data(){return{isLogin:!1}},created(){const e=localStorage.getItem("token");e&&(this.isLogin=!0)},methods:{async doLogout(){localStorage.clear(),await this.$router.push("/login"),window.location.reload()}}},d=o(1241);const u=(0,d.A)(c,[["render",i],["__scopeId","data-v-e7a01266"]]);var m=u;const p="login-required";function h(e={}){"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent(p,{detail:e}))}var f={__name:"App",setup(e){const t=(0,s.rd)(),o=(0,l.KR)(!1),n=()=>{o.value=!1},r=()=>{n(),t.push("/login")},i=()=>{o.value=!0};return(0,a.sV)((()=>{window.addEventListener(p,i)})),(0,a.xo)((()=>{window.removeEventListener(p,i)})),(e,t)=>{const l=(0,a.g2)("router-view"),s=(0,a.g2)("v-main"),i=(0,a.g2)("v-card-title"),c=(0,a.g2)("v-card-text"),d=(0,a.g2)("v-spacer"),u=(0,a.g2)("v-btn"),p=(0,a.g2)("v-card-actions"),h=(0,a.g2)("v-card"),f=(0,a.g2)("v-dialog"),g=(0,a.g2)("v-app");return(0,a.uX)(),(0,a.Wv)(g,{id:"inspire"},{default:(0,a.k6)((()=>[(0,a.bF)(m),(0,a.bF)(s,{class:"bg-grey-lighten-4"},{default:(0,a.k6)((()=>[(0,a.bF)(l)])),_:1}),(0,a.bF)(f,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),width:"420",persistent:""},{default:(0,a.k6)((()=>[(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(i,{class:"text-h5 font-weight-bold"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)(" 로그인 후 이용해주세요 ")]))),_:1}),(0,a.bF)(c,null,{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)(" 회원 목록과 채팅 기능은 로그인한 사용자만 이용할 수 있습니다. 로그인 후 다시 시도해주세요. ")]))),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(d),(0,a.bF)(u,{variant:"text",onClick:n},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)(" 닫기 ")]))),_:1}),(0,a.bF)(u,{color:"primary",variant:"flat",onClick:r},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)(" 로그인 하러가기 ")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}}};const g=f;var v=g,k=(o(5524),o(7768)),b=o(9835),y=o(8221),w=(0,k.$N)({components:b,icons:{defaultSet:"mdi",aliases:y.z,sets:{mdi:y.r}}});function C(e,t,o,l,s,r){const i=(0,a.g2)("v-text-field"),c=(0,a.g2)("v-btn"),d=(0,a.g2)("v-form"),u=(0,a.g2)("v-card-text"),m=(0,a.g2)("v-card"),p=(0,a.g2)("v-col"),h=(0,a.g2)("v-row"),f=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(f,{class:"signup-shell",fluid:""},{default:(0,a.k6)((()=>[(0,a.bF)(h,{class:"fill-height",align:"center",justify:"center"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{cols:"12",md:"8",lg:"5"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{class:"signup-card",elevation:"0"},{default:(0,a.k6)((()=>[t[4]||(t[4]=(0,a.Lk)("div",{class:"signup-header"},[(0,a.Lk)("p",{class:"eyebrow"},"Join us"),(0,a.Lk)("h2",null,"회원가입"),(0,a.Lk)("p",{class:"subtitle"},"채팅과 피아노 연주를 함께 즐겨보세요.")],-1)),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{onSubmit:(0,n.D$)(r.memberCreate,["prevent"]),class:"signup-form"},{default:(0,a.k6)((()=>[(0,a.bF)(i,{label:"이름",modelValue:s.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.name=e),variant:"outlined",color:"primary","prepend-inner-icon":"mdi-account",required:""},null,8,["modelValue"]),(0,a.bF)(i,{label:"Email",modelValue:s.email,"onUpdate:modelValue":t[1]||(t[1]=e=>s.email=e),type:"email",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-email",required:""},null,8,["modelValue"]),(0,a.bF)(i,{label:"Password",modelValue:s.password,"onUpdate:modelValue":t[2]||(t[2]=e=>s.password=e),type:"password",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-lock",required:""},null,8,["modelValue"]),(0,a.bF)(c,{type:"submit",color:"primary",class:"signup-btn",size:"large","prepend-icon":"mdi-check"},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)(" 등록 ")]))),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var L=o(4373),_={data(){return{name:"",email:"",password:""}},methods:{async memberCreate(){const e={name:this.name,email:this.email,password:this.password};await L.A.post("http://49.50.139.5:8080/member/create",e),this.$router.push("/")}}};const F=(0,d.A)(_,[["render",C],["__scopeId","data-v-9a56fae0"]]);var A=F;function E(e,t,o,l,s,r){const i=(0,a.g2)("v-text-field"),c=(0,a.g2)("v-btn"),d=(0,a.g2)("v-form"),u=(0,a.g2)("v-card-text"),m=(0,a.g2)("v-card"),p=(0,a.g2)("v-col"),h=(0,a.g2)("v-row"),f=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(f,{class:"login-shell",fluid:""},{default:(0,a.k6)((()=>[(0,a.bF)(h,{class:"fill-height",align:"center",justify:"center"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{cols:"12",md:"8",lg:"5"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{class:"login-card",elevation:"0"},{default:(0,a.k6)((()=>[t[3]||(t[3]=(0,a.Lk)("div",{class:"login-header"},[(0,a.Lk)("p",{class:"eyebrow"},"Welcome Back"),(0,a.Lk)("h2",null,"로그인"),(0,a.Lk)("p",{class:"subtitle"},"나의 채팅 공간으로 돌아와주세요.")],-1)),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{onSubmit:(0,n.D$)(r.doLogin,["prevent"]),class:"login-form"},{default:(0,a.k6)((()=>[(0,a.bF)(i,{label:"Email",modelValue:s.email,"onUpdate:modelValue":t[0]||(t[0]=e=>s.email=e),type:"email",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-email",required:""},null,8,["modelValue"]),(0,a.bF)(i,{label:"Password",modelValue:s.password,"onUpdate:modelValue":t[1]||(t[1]=e=>s.password=e),type:"password",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-lock",required:""},null,8,["modelValue"]),(0,a.bF)(c,{type:"submit",color:"primary",class:"login-btn",size:"large","prepend-icon":"mdi-login"},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)(" 로그인 ")]))),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var x=o(5068),M={data(){return{email:"",password:""}},methods:{async doLogin(){const e={email:this.email,password:this.password},t=await L.A.post("http://49.50.139.5:8080/member/doLogin",e),o=t.data.token,n=(0,x.s)(o).role,a=(0,x.s)(o).sub;localStorage.setItem("token",o),localStorage.setItem("role",n),localStorage.setItem("email",a),window.location.href="/"}}};const I=(0,d.A)(M,[["render",E],["__scopeId","data-v-2cc2fb7a"]]);var W=I,$=o(4232);const P={class:"member-header"},S={class:"member-info"},O={class:"member-name"},R={class:"text-right"},N={key:0};function V(e,t,o,n,l,s){const r=(0,a.g2)("v-chip"),i=(0,a.g2)("v-btn"),c=(0,a.g2)("v-table"),d=(0,a.g2)("v-card"),u=(0,a.g2)("v-col"),m=(0,a.g2)("v-row"),p=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(p,{class:"member-shell"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{justify:"center"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{cols:"12",lg:"10"},{default:(0,a.k6)((()=>[(0,a.bF)(d,{class:"member-card",elevation:"0"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",P,[t[0]||(t[0]=(0,a.Lk)("div",null,[(0,a.Lk)("p",{class:"eyebrow"},"Team Directory"),(0,a.Lk)("h2",null,"회원 목록"),(0,a.Lk)("p",{class:"subtitle"},"함께 채팅할 멤버를 선택하세요.")],-1)),(0,a.bF)(r,{color:"primary",variant:"flat",class:"count-chip",size:"small"},{default:(0,a.k6)((()=>[(0,a.eW)(" 총 "+(0,$.v_)(l.memberList.length)+"명 ",1)])),_:1})]),(0,a.bF)(c,{class:"member-table"},{default:(0,a.k6)((()=>[t[3]||(t[3]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"ID"),(0,a.Lk)("th",null,"이름"),(0,a.Lk)("th",null,"Email")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.memberList,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",null,"#"+(0,$.v_)(e.id),1),(0,a.Lk)("td",null,[(0,a.Lk)("div",S,[(0,a.Lk)("div",null,[(0,a.Lk)("p",O,(0,$.v_)(e.name),1)])])]),(0,a.Lk)("td",null,(0,$.v_)(e.email),1),(0,a.Lk)("td",R,[(0,a.bF)(i,{class:"pill-btn",color:"primary",variant:"flat","prepend-icon":"mdi-message-processing",onClick:t=>s.startChat(e.id)},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)(" 채팅하기 ")]))),_:2},1032,["onClick"])])])))),128)),l.memberList.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("tr",N,t[2]||(t[2]=[(0,a.Lk)("td",{colspan:"4",class:"empty-state"}," 표시할 회원이 없습니다. ",-1)])))])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}function D(e){const t=e?.response?.status;return 401===t||403===t}function T(e,t){D(t)||console.error(e,t)}var B={data(){return{memberList:[]}},async created(){await this.loadMembers()},methods:{async loadMembers(){try{const e=await L.A.get("http://49.50.139.5:8080/member/list");this.memberList=e.data}catch(e){T("회원 목록을 불러오지 못했습니다.",e)}},async startChat(e){try{const t=await L.A.post(`http://49.50.139.5:8080/chat/room/private/create?otherMemberId=${e}`),o=t.data;this.$router.push(`/chatpage/${o}`)}catch(t){T("채팅방 생성에 실패했습니다.",t)}}}};const X=(0,d.A)(B,[["render",V],["__scopeId","data-v-9f400254"]]);var j=X;const q={class:"chat-box"};function U(e,t,o,l,s,r){const i=(0,a.g2)("v-card-title"),c=(0,a.g2)("v-text-field"),d=(0,a.g2)("v-btn"),u=(0,a.g2)("v-card-text"),m=(0,a.g2)("v-card"),p=(0,a.g2)("v-col"),h=(0,a.g2)("v-row"),f=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(f,null,{default:(0,a.k6)((()=>[(0,a.bF)(h,{justify:"center"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{cols:"12",md:"8"},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.bF)(i,{class:"text-center text-h5"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)(" 채팅 ")]))),_:1}),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",q,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.messages,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},(0,$.v_)(e),1)))),128))]),(0,a.bF)(c,{modelValue:s.newMessage,"onUpdate:modelValue":t[0]||(t[0]=e=>s.newMessage=e),label:"메시지 입력",onKeyup:(0,n.jR)(r.sendMessage,["enter"])},null,8,["modelValue","onKeyup"]),(0,a.bF)(d,{color:"primary",block:"",onClick:r.sendMessage},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("전송")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var K={data(){return{ws:null,messages:[],newMessage:""}},created(){this.connectWebsocket()},beforeUnmount(){this.disconnectWebSocket()},methods:{connectWebsocket(){this.ws=new WebSocket("ws://localhost:8080/connect"),this.ws.onopen=()=>{console.log("succeessfully connected!!")},this.ws.onmessage=e=>{this.messages.push(e.data),this.scrollToBottom()},this.ws.onclose=()=>{console.log("disconnected!!")}},sendMessage(){""!==this.newMessage.trim()&&(this.ws.send(this.newMessage),this.newMessage="")},scrollToBottom(){this.$nextTick((()=>{const e=this.$el.querySelector(".chat-box");e.scrollTop=e.scrollHeight}))},disconnectWebSocket(){this.ws&&(this.ws.close(),console.log("disconnected!!"),this.ws=null)}}};const G=(0,d.A)(K,[["render",U]]);var z=G;o(8992),o(3949),o(1454);const H=(e=0)=>440*Math.pow(2,e/12),Q=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],J=(e,t)=>{let o=0,n=-2;return Array(t-e).fill().map(((t,a)=>{const l=(e+a)%12,s=Q[l<0?12+l:l],r=Math.ceil(4+(e+a)/12);return 0===a&&"C"===s&&(o=-3),s.includes("#")?(o+=3,["C#","F#"].includes(s)&&(o+=3)):n+=3,{note:s,freq:H(e+a),octave:"B"===s||"A#"===s?r-1:r,offset:s.includes("#")?o:n}}))},Z=e=>e.map((e=>`\n    <button type="button"\n        tabindex="-1"\n        aria-label="${e.note}${e.octave}" \n        data-note="${e.note}${e.octave}" \n        style="--gcs:${e.offset}">\n    </button>`)).join("\n"),Y=(e="kb88",t=-48,o=40)=>{const n="string"===typeof e?document.getElementById(e):e;n?n.innerHTML=Z(J(t,o)):console.warn("[pianoRender] target element not found:",e)};var ee=Y,te=o(1850),oe=o(6615),ne=o(6968),ae=o.n(ne),le=o(9769),se=o.n(le);const re={class:"chat-panel"},ie={class:"chat-panel__messages"},ce={class:"chat-row__inner"},de={class:"chat-row__meta"},ue={class:"chat-row__text"},me={class:"chat-panel__input"},pe={class:"piano-control-region"},he={class:"control-option-buttons"},fe={class:"control-card"},ge={class:"control-card__top"},ve={class:"control-section"},ke={data(){return{messages:[],newMessage:"",stompClient:null,token:"",senderEmail:null,roomId:null,roomName:"",showControlPanel:!1,activeControlOption:null}},watch:{messages:{deep:!0,handler(){this.$nextTick((()=>this.scrollToBottom()))}}},async created(){this.senderEmail=localStorage.getItem("email"),this.roomId=this.$route.params.roomId,await this.fetchRoomInfo(),await this.loadChatHistory(),this.connectWebsocket()},beforeUnmount(){this.disconnectWebSocket()},mounted(){},methods:{async fetchRoomInfo(){try{const{data:e}=await L.A.get(`http://49.50.139.5:8080/chat/getRoomInfo/${this.roomId}`);this.roomName=e.roomName}catch(e){T("채팅방 정보를 불러오지 못했습니다.",e)}},async loadChatHistory(){try{const e=await L.A.get(`http://49.50.139.5:8080/chat/history/${this.roomId}`);this.messages=e.data,this.$nextTick((()=>this.scrollToBottom()))}catch(e){T("채팅 기록을 불러오지 못했습니다.",e)}},connectWebsocket(){if(this.stompClient&&this.stompClient.connected)return;const e=new(ae())("http://49.50.139.5:8080/connect");this.stompClient=se().over(e),this.token=localStorage.getItem("token"),this.stompClient.connect({Authorization:`Bearer ${this.token}`},(()=>{this.stompClient.subscribe(`/topic/${this.roomId}`,(e=>{const t=JSON.parse(e.body);"message"===t.type?(this.messages.push(t),this.scrollToBottom()):"piano"===t.type&&("on"===t.onOff&&this.playNoteOn(t.note),"off"===t.onOff&&this.playNoteOff(t.note))}),{Authorization:`Bearer ${this.token}`})}))},sendMessage(){if(""===this.newMessage.trim())return;if(!this.stompClient||!this.stompClient.connected)return void console.warn("STOMP connection not ready. Message not sent.");const e={type:"message",senderEmail:this.senderEmail,message:this.newMessage};this.stompClient.send(`/publish/chat/${this.roomId}`,JSON.stringify(e)),this.newMessage=""},scrollToBottom(){this.$nextTick((()=>{const e=this.$el.querySelector(".chat-panel__messages");e.scrollTop=e.scrollHeight}))},async disconnectWebSocket(){try{await L.A.post(`http://49.50.139.5:8080/chat/room/${this.roomId}/read`)}catch(e){T("메시지 읽음 처리에 실패했습니다.",e)}this.stompClient&&this.stompClient.connected&&(this.stompClient.unsubscribe(`/topic/${this.roomId}`),this.stompClient.disconnect())},getInitial(e){return e?e.trim().charAt(0).toUpperCase():"?"},toggleControlPanel(e){if(this.showControlPanel&&this.activeControlOption===e)return this.showControlPanel=!1,void(this.activeControlOption=null);this.activeControlOption=e,this.showControlPanel=!0},closeControlPanel(){this.showControlPanel=!1,this.activeControlOption=null}}};var be=Object.assign(ke,{__name:"StompChatPage",setup(e){const{proxy:t}=(0,a.nI)(),o=e=>{if(!e)return!1;const t=e.tagName;return"INPUT"===t||"TEXTAREA"===t||e.isContentEditable};return(0,s.JZ)((()=>{t?.disconnectWebSocket&&t.disconnectWebSocket()})),(0,a.sV)((()=>{ee("chat-piano");let e=!1;document.addEventListener("keydown",(async()=>{e||(await te.ni(),e=!0)}));const n=new te.LC({urls:{A0:"A0.mp3",C1:"C1.mp3","D#1":"Ds1.mp3","F#1":"Fs1.mp3",A1:"A1.mp3",C2:"C2.mp3","D#2":"Ds2.mp3","F#2":"Fs2.mp3",A2:"A2.mp3",C3:"C3.mp3","D#3":"Ds3.mp3","F#3":"Fs3.mp3",A3:"A3.mp3",C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3",C5:"C5.mp3","D#5":"Ds5.mp3","F#5":"Fs5.mp3",A5:"A5.mp3",C6:"C6.mp3","D#6":"Ds6.mp3","F#6":"Fs6.mp3",A6:"A6.mp3",C7:"C7.mp3","D#7":"Ds7.mp3","F#7":"Fs7.mp3",A7:"A7.mp3",C8:"C8.mp3"},volume:1,mute:!1,release:1,baseUrl:"https://tonejs.github.io/audio/salamander/"}).toDestination(),a=document.querySelectorAll("button[data-note]"),l="#a855f7",s=()=>l,r=15,i=420,c=.28,d=220,u=new WeakMap,m=()=>{const e=window.innerHeight||i;return Math.max(i,e+260)};function p(e){const t=u.get(e);t&&(t.raf&&cancelAnimationFrame(t.raf),t.effect.remove(),u.delete(e))}function h(e){if(!e)return;p(e);const t=document.createElement("span");t.className="synthesia-effect",t.style.setProperty("--effect-color",s()),t.style.setProperty("--effect-length",`${r}px`),e.appendChild(t);const o={effect:t,start:performance.now(),raf:null,maxHeight:m()},n=()=>{const e=performance.now()-o.start,a=Math.min(r+e*c,o.maxHeight||i);t.style.setProperty("--effect-length",`${a}px`),o.raf=requestAnimationFrame(n)};n(),u.set(e,o)}function f(e){const t=u.get(e);if(!t)return;t.raf&&cancelAnimationFrame(t.raf);const{effect:o,start:n}=t,a=parseFloat(o.style.getPropertyValue("--effect-length")||r)||r;o.style.setProperty("--effect-length",`${a}px`);const l=performance.now()-n,s=Math.min(2.2,Math.max(.6,l/600)),i=e?.getBoundingClientRect?.(),c=Math.max(0,i?i.top:window.innerHeight),m=c+a+d,p=320,h=Math.max(.9,m/p),f=Math.min(4.2,Math.max(s,h));o.style.setProperty("--effect-rise-duration",`${f}s`),o.style.setProperty("--effect-rise-distance",`${m}px`),o.classList.add("synthesia-effect--rise"),o.addEventListener("animationend",(()=>o.remove()),{once:!0}),u.delete(e)}let g=0;const v=document.getElementById("octave"),k=document.getElementById("octave-display"),b=()=>{if(k){const e=g>0?"+":"";k.textContent=`${e}${g}`}},y=()=>{v&&(v.value=g),b()};if(v){const e=Number(v.value);Number.isNaN(e)||(g=e),b(),v.addEventListener("input",(()=>{const e=Number(v.value);Number.isNaN(e)||(g=e),b()}))}else console.warn("[tone] #octave element not found. Transpose controls disabled.");const w={ArrowLeft:-1,ArrowRight:1,ArrowUp:12,ArrowDown:-12,CapsLock:-12,Alt:24};function C(e,o){if(!t?.stompClient||!t.stompClient.connected)return void console.warn("STOMP connection not ready. Piano event not sent.");const n={type:"piano",note:e,onOff:o};t.stompClient.send(`/publish/piano/${t?.roomId}`,JSON.stringify(n))}document.addEventListener("keydown",(e=>{e.repeat||w[e.key]&&(e.key.includes("Arrow")&&e.preventDefault(),g+=w[e.key],y())})),document.addEventListener("keyup",(e=>{"CapsLock"==e.key&&(g-=w[e.key],y()),"Alt"==e.key&&(g-=w[e.key],y()),w[e.key]&&e.key.includes("Arrow")&&e.preventDefault()}));const L=new Map;function _(e){console.log("noteOn = "+e);const t=M(e);n.triggerAttack(t),I(t,"on"),L.set(e,t)}function F(e){console.log("noteoff = "+e);const t=L.get(e);t&&(x||n.triggerRelease(t),I(t,"off"),L.delete(e))}function A(e){C(e,"on")}function E(e){C(e,"off")}t.playNoteOn=_,t.playNoteOff=F;let x=!1;function M(e){return te.jN(e).transpose(g).toNote()}function I(e,t){const o=document.querySelector(`button[data-note="${e}"]`);o&&("on"==t?(o.classList.add("keydown"),h(o)):(o.classList.remove("keydown"),f(o)))}0===a.length?console.warn("[tone] piano keys not found. Pointer controls disabled."):a.forEach((e=>{e.addEventListener("pointerdown",(()=>{A(e.getAttribute("data-note"))})),e.addEventListener("pointerup",(()=>{E(e.getAttribute("data-note"))})),e.addEventListener("pointerleave",(()=>{E(e.getAttribute("data-note"))}))}));const W={MPP:{49:"G#3",50:"A#3",52:"C#4",53:"D#4",55:"F#4",56:"G#4",57:"A#4",45:"C#5",61:"D#5",113:"A3",119:"B3",101:"C4",114:"D4",116:"E4",121:"F4",117:"G4",105:"A4",111:"B4",112:"C5",91:"D5",93:"E5",97:"G#2",115:"A#2",102:"C#3",103:"D#3",106:"F#3",107:"G#3",108:"A#3",39:"C#4",122:"A2",120:"B2",99:"C3",118:"D3",98:"E3",110:"F3",109:"G3",44:"A3",46:"B3",47:"C4"}};document.addEventListener("keydown",(e=>{if(o(e.target))return;if(e.repeat)return;if(!W.MPP[e.key.charCodeAt(0)])return;const t=W.MPP[e.key.charCodeAt(0)];A(t)})),document.addEventListener("keyup",(e=>{if(o(e.target))return;if(!W.MPP[e.key.charCodeAt(0)])return;const t=W.MPP[e.key.charCodeAt(0)];E(t)}));const $=document.getElementById("sustain-btn"),P=()=>{$&&($.innerText=x?"페달 ON":"페달 OFF")};function S(){x=!x,P()}$?(P(),$.addEventListener("click",S)):console.warn("[tone] #sustain-btn element not found. Sustain button disabled."),document.addEventListener("keydown",(e=>{"Backspace"===e.key&&S()," "===e.key&&(x=!0,P())})),document.addEventListener("keyup",(e=>{" "===e.key&&(x=!1,P())}));const O=document.getElementById("volume"),R=document.getElementById("volume-display"),N=e=>{R&&(R.textContent=`${e} dB`)};if(O){const e=Number(O.value),t=Number.isNaN(e)?0:e;n.volume.value=t,N(t),O.addEventListener("input",(()=>{const e=Number(O.value);Number.isNaN(e)||(n.volume.value=e,N(e))}))}else console.warn("[tone] #volume element not found. Volume slider disabled.");function V(){console.log("미디 접근 허용"),oe.OK.inputs.length<1?console.log("MIDI장치를 연결해주세요"):oe.OK.inputs.forEach((e=>{console.log("===장치 정보==="),console.log(e.id),console.log(e.manufacturer),console.log(e.name),console.log("===============")}));const e=oe.OK.inputs[0];e?(e.channels[1].addListener("noteon",(e=>{const t=e.note.identifier;A(t)})),e.channels[1].addListener("noteoff",(e=>{const t=e.note.identifier;E(t)}))):console.log("MIDI 장치를 찾을 수 없습니다.")}oe.OK.enable().then(V).catch((e=>{console.error("미디 접근을 허용해주세요:",e)}))})),(e,t)=>{const o=(0,a.g2)("v-btn"),l=(0,a.g2)("v-text-field"),s=(0,a.g2)("v-navigation-drawer"),r=(0,a.g2)("v-container"),i=(0,a.g2)("v-main"),c=(0,a.g2)("v-app");return(0,a.uX)(),(0,a.Wv)(c,{id:"inspire"},{default:(0,a.k6)((()=>[(0,a.bF)(i,{class:"bg-grey-lighten-5 chat-main"},{default:(0,a.k6)((()=>[(0,a.bF)(s,{app:"",permanent:"",class:"chat-drawer",width:360},{default:(0,a.k6)((()=>[(0,a.Lk)("div",re,[(0,a.Lk)("div",ie,[(0,a.bF)(n.F,{name:"chat-fade",tag:"div",class:"chat-panel__stream"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.messages,((t,o)=>((0,a.uX)(),(0,a.CE)("div",{key:`${t.senderEmail}-${o}`,class:"chat-row"},[(0,a.Lk)("div",ce,[(0,a.Lk)("span",de,(0,$.v_)(t.senderEmail===e.senderEmail?"나:":t.senderEmail),1),(0,a.Lk)("p",ue,(0,$.v_)(" "+t.message),1)])])))),128))])),_:1})]),(0,a.Lk)("div",me,[(0,a.bF)(l,{modelValue:e.newMessage,"onUpdate:modelValue":t[0]||(t[0]=t=>e.newMessage=t),label:"메시지 입력",variant:"outlined","hide-details":"",density:"comfortable",color:"deep-purple-accent-2",onKeyup:(0,n.jR)(e.sendMessage,["enter"])},{"append-inner":(0,a.k6)((()=>[(0,a.bF)(o,{icon:"mdi-send-variant-outline",variant:"text",density:"comfortable",color:"deep-purple-accent-2",onClick:(0,n.D$)(e.sendMessage,["stop"])},null,8,["onClick"])])),_:1},8,["modelValue","onKeyup"])])])])),_:1}),(0,a.Lk)("div",pe,[(0,a.Lk)("div",he,[(0,a.bF)(o,{class:(0,$.C4)(["option-btn",{"option-btn--active":"pedal"===e.activeControlOption}]),size:"small",variant:"tonal",color:"deep-purple-accent-2",onClick:t[1]||(t[1]=t=>e.toggleControlPanel("pedal"))},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)(" 설정 ")]))),_:1},8,["class"])]),(0,a.Lk)("div",{class:(0,$.C4)(["piano-control-panel",{"is-visible":e.showControlPanel}])},[(0,a.Lk)("div",fe,[(0,a.Lk)("div",ge,[t[3]||(t[3]=(0,a.Lk)("p",{class:"control-label"}," 옵션",-1)),(0,a.bF)(o,{icon:"mdi-close",variant:"text",density:"comfortable",onClick:e.closeControlPanel},null,8,["onClick"])]),(0,a.Lk)("div",ve,[t[5]||(t[5]=(0,a.Lk)("p",{class:"control-label"},"페달",-1)),(0,a.bF)(o,{id:"sustain-btn",class:"control-btn",variant:"outlined",color:"deep-purple-accent-2",size:"small"},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)(" 페달 OFF ")]))),_:1})]),t[6]||(t[6]=(0,a.Lk)("div",{class:"control-section"},[(0,a.Lk)("div",{class:"control-header"},[(0,a.Lk)("p",{class:"control-label"},"Key"),(0,a.Lk)("span",{id:"octave-display",class:"control-value"},"0")]),(0,a.Lk)("input",{id:"octave",class:"control-slider",type:"range",min:"-24",max:"24",step:"1",value:"0"})],-1)),t[7]||(t[7]=(0,a.Lk)("div",{class:"control-section"},[(0,a.Lk)("div",{class:"control-header"},[(0,a.Lk)("p",{class:"control-label"},"사운드"),(0,a.Lk)("span",{id:"volume-display",class:"control-value"},"0 dB")]),(0,a.Lk)("input",{id:"volume",class:"control-slider",type:"range",min:"-30",max:"6",step:"1",value:"0"})],-1))])],2)]),(0,a.bF)(r,{class:"chat-piano-container"},{default:(0,a.k6)((()=>t[8]||(t[8]=[(0,a.Lk)("div",{class:"piano-wrapper"},[(0,a.Lk)("div",{id:"chat-piano",class:"kb piano-responsive"})],-1)]))),_:1})])),_:1})])),_:1})}}});const ye=be;var we=ye;const Ce={class:"room-header"},Le={class:"room-info"},_e={class:"room-name"},Fe={class:"text-right"},Ae={key:0};function Ee(e,t,o,n,l,s){const r=(0,a.g2)("v-btn"),i=(0,a.g2)("v-table"),c=(0,a.g2)("v-card"),d=(0,a.g2)("v-col"),u=(0,a.g2)("v-row"),m=(0,a.g2)("v-card-title"),p=(0,a.g2)("v-text-field"),h=(0,a.g2)("v-card-text"),f=(0,a.g2)("v-card-actions"),g=(0,a.g2)("v-dialog"),v=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(v,{class:"room-shell"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{justify:"center"},{default:(0,a.k6)((()=>[(0,a.bF)(d,{cols:"12",lg:"10"},{default:(0,a.k6)((()=>[(0,a.bF)(c,{class:"room-card",elevation:"0"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",Ce,[t[5]||(t[5]=(0,a.Lk)("div",null,[(0,a.Lk)("p",{class:"eyebrow"},"Group Sessions"),(0,a.Lk)("h2",null,"채팅방 목록"),(0,a.Lk)("p",{class:"subtitle"},"참여하거나 새 방을 만들어보세요.")],-1)),(0,a.bF)(r,{class:"pill-btn",color:"primary",variant:"flat","prepend-icon":"mdi-plus",onClick:t[0]||(t[0]=e=>l.showCreateRoomModal=!0)},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)(" 채팅방 생성 ")]))),_:1})]),(0,a.bF)(i,{class:"room-table"},{default:(0,a.k6)((()=>[t[8]||(t[8]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"방 번호"),(0,a.Lk)("th",null,"방 제목")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.chatRoomList,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.roomId},[(0,a.Lk)("td",null,"#"+(0,$.v_)(e.roomId),1),(0,a.Lk)("td",null,[(0,a.Lk)("div",Le,[(0,a.Lk)("div",null,[(0,a.Lk)("p",_e,(0,$.v_)(e.roomName),1)])])]),(0,a.Lk)("td",Fe,[(0,a.bF)(r,{class:"pill-btn",color:"primary",variant:"tonal","prepend-icon":"mdi-login",onClick:t=>s.joinChatRoom(e.roomId)},{default:(0,a.k6)((()=>t[6]||(t[6]=[(0,a.eW)(" 참여하기 ")]))),_:2},1032,["onClick"])])])))),128)),l.chatRoomList.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("tr",Ae,t[7]||(t[7]=[(0,a.Lk)("td",{colspan:"4",class:"empty-state"},"생성된 방이 없습니다.",-1)])))])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(g,{modelValue:l.showCreateRoomModal,"onUpdate:modelValue":t[3]||(t[3]=e=>l.showCreateRoomModal=e),"max-width":"500px"},{default:(0,a.k6)((()=>[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(m,{class:"text-h6"},{default:(0,a.k6)((()=>t[9]||(t[9]=[(0,a.eW)(" 채팅방 생성 ")]))),_:1}),(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(p,{label:"방제목",modelValue:l.newRoomTitle,"onUpdate:modelValue":t[1]||(t[1]=e=>l.newRoomTitle=e)},null,8,["modelValue"])])),_:1}),(0,a.bF)(f,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{color:"grey",onClick:t[2]||(t[2]=e=>l.showCreateRoomModal=!1)},{default:(0,a.k6)((()=>t[10]||(t[10]=[(0,a.eW)(" 취소 ")]))),_:1}),(0,a.bF)(r,{color:"primary",onClick:s.createChatRoom},{default:(0,a.k6)((()=>t[11]||(t[11]=[(0,a.eW)(" 생성 ")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}var xe={data(){return{chatRoomList:[],showCreateRoomModal:!1,newRoomTitle:""}},async created(){await this.loadChatRoom()},methods:{async joinChatRoom(e){try{await L.A.post(`http://49.50.139.5:8080/chat/room/group/${e}/join`),this.$router.push(`/chatpage/${e}`)}catch(t){T("채팅방 참여에 실패했습니다.",t)}},async createChatRoom(){try{await L.A.post(`http://49.50.139.5:8080/chat/room/group/create?roomName=${this.newRoomTitle}`,null),this.showCreateRoomModal=!1,await this.loadChatRoom()}catch(e){T("채팅방 생성에 실패했습니다.",e)}},async loadChatRoom(){try{const e=await L.A.get("http://49.50.139.5:8080/chat/room/group/list");this.chatRoomList=e.data}catch(e){T("채팅방 목록을 불러오지 못했습니다.",e)}}}};const Me=(0,d.A)(xe,[["render",Ee],["__scopeId","data-v-46c1800f"]]);var Ie=Me;const We={class:"action-cell"};function $e(e,t,o,n,l,s){const r=(0,a.g2)("v-card-title"),i=(0,a.g2)("v-btn"),c=(0,a.g2)("v-table"),d=(0,a.g2)("v-card-text"),u=(0,a.g2)("v-card"),m=(0,a.g2)("v-col"),p=(0,a.g2)("v-row"),h=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{class:"text-center text-h5"},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.eW)(" 내 채팅 목록 ")]))),_:1}),(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[t[3]||(t[3]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"채팅방 이름"),(0,a.Lk)("th",null,"읽지 않은 메시지"),(0,a.Lk)("th",null,"액션")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.chatList,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.roomId},[(0,a.Lk)("td",null,(0,$.v_)(e.roomName),1),(0,a.Lk)("td",null,(0,$.v_)(e.unReadCount),1),(0,a.Lk)("td",We,[(0,a.bF)(i,{class:"action-btn",color:"primary",onClick:t=>s.enterChatRoom(e.roomId)},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("입장")]))),_:2},1032,["onClick"]),(0,a.bF)(i,{class:"action-btn",color:"secondary",disabled:"N"===e.isGroupChat,onClick:t=>s.leaveChatRoom(e.roomId)},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("나가기")]))),_:2},1032,["disabled","onClick"])])])))),128))])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}o(4520);var Pe={data(){return{chatList:[]}},async created(){await this.loadChatRooms()},methods:{async loadChatRooms(){try{const e=await L.A.get("http://49.50.139.5:8080/chat/my/rooms");this.chatList=e.data}catch(e){T("채팅 목록을 불러오지 못했습니다.",e)}},enterChatRoom(e){this.$router.push(`/chatpage/${e}`)},async leaveChatRoom(e){try{await L.A.delete(`http://49.50.139.5:8080/chat/room/group/${e}/leave`),this.chatList=this.chatList.filter((t=>t.roomId!==e))}catch(t){T("채팅방 나가기에 실패했습니다.",t)}}}};const Se=(0,d.A)(Pe,[["render",$e]]);var Oe=Se;const Re=[{path:"/member/create",name:"MemberCreate",component:A},{path:"/login",name:"LoginPage",component:W},{path:"/member/list",name:"MemberList",component:j,meta:{requiresAuth:!0}},{path:"/simple/chat",name:"SimpleWebsocket",component:z},{path:"/chatpage/:roomId",name:"StompChatPage",component:we,meta:{requiresAuth:!0}},{path:"/groupchatting/list",name:"GroupChattingList",component:Ie,meta:{requiresAuth:!0}},{path:"/my/chat/page",name:"MyChatPage",component:Oe,meta:{requiresAuth:!0}}],Ne=(0,s.aE)({history:(0,s.Bt)(),routes:Re});Ne.beforeEach(((e,t,o)=>{if("/"!==e.path){if(e.meta.requiresAuth){const t=localStorage.getItem("token");if(!t)return h({redirectFrom:e.fullPath}),void o("/login")}o()}else{const e=localStorage.getItem("token");o(e?"/groupchatting/list":"/login")}}));var Ve=Ne;const De=(0,n.Ef)(v);L.A.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers["Authorization"]=`Bearer ${t}`),e}),(e=>Promise.reject(e))),L.A.interceptors.response.use((e=>e),(e=>{const t=e?.response?.status;return 401!==t&&403!==t||h(),Promise.reject(e)})),De.use(Ve),De.use(w),De.mount("#app")}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,o),l.exports}o.m=e,function(){var e=[];o.O=function(t,n,a,l){if(!n){var s=1/0;for(d=0;d<e.length;d++){n=e[d][0],a=e[d][1],l=e[d][2];for(var r=!0,i=0;i<n.length;i++)(!1&l||s>=l)&&Object.keys(o.O).every((function(e){return o.O[e](n[i])}))?n.splice(i--,1):(r=!1,l<s&&(s=l));if(r){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[n,a,l]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,l,s=n[0],r=n[1],i=n[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(i)var d=i(o)}for(t&&t(n);c<s.length;c++)l=s[c],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(d)},n=self["webpackChunkchat_front"]=self["webpackChunkchat_front"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],(function(){return o(2508)}));n=o.O(n)})();
//# sourceMappingURL=app.cc7c929a.js.map